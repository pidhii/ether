
OS.chdir (List.get 1 command_line);

let test_mergesort! =
  let origlist = [1,9,4,5,7,6,8,2,3] in
  let ret =
    origlist
    |> List.map (format "%d")
    |> String.join "\n"
    |> (x -> IO.shell {q|ether ./mergesort.eth <<<'{x}' | grep "Sorted list"|q})
    |> String.match \\[.+\]/
    |> car
  in
  let correct =
    List.sort (<) origlist
    |> List.map (format "%d")
    |> String.join ","
    |> format "[%d]"
  in
  assert ret eq correct in
  nil
in

let test_basics! =
  assert system "ether ./basics.eth &>/dev/null" == 0 in
  nil
in

test_basics!;
test_mergesort!; 
